name: Keep Render Server Alive
on:
  schedule:
    # every 10 minute
    - cron: '*/10 * * * *'
  # for Manualy
  workflow_dispatch:

jobs:
  ping-server:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render Server
        run: |
          echo "üïê Pinging server at $(date)"
          
          # ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶ï‡ßç‡¶∏‡¶æ‡¶ï‡ßç‡¶ü URL ‡¶¶‡¶ø‡¶®
          RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" \
            "https://liftakids.onrender.com/LiftAKids/api/health/wakeup")
          
          if [ "$RESPONSE" -eq 200 ]; then
            echo "‚úÖ Server is awake (Status: $RESPONSE)"
          else
            echo "‚ö†Ô∏è Server responded with: $RESPONSE"
            echo "Trying again in 30 seconds..."
            sleep 30
            # Retry
            RESPONSE2=$(curl -s -o /dev/null -w "%{http_code}" \
              "https://liftakids.onrender.com/LiftAKids/api/health/wakeup")
            echo "Retry status: $RESPONSE2"
          fi